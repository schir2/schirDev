{% extends 'tools/base.html' %}
{% block head_title %}Retirement Calculator{% endblock %}
{% block content %}
    <h1 class="text-4xl font-semibold mb-6">Retirement Calculator</h1>
    <div x-data="retirementCalculator()" class="grid grid-cols-2">
    <div class="space-y-3">
        <div class="p-3 border">
            <h2 class="text-2xl font-semibold">Personal Information</h2>
            <div class="grid grid-cols-3 gap-3">
                <c-input :field="form.current_age" x-model="formData.current_age"/>
                <c-input :field="form.retirement_age" x-model="formData.retirement_age"/>
                <c-input :field="form.life_expectancy" x-model="formData.life_expectancy"/>
            </div>
        </div>

        <div class="p-3 border">
            <h2 class="text-2xl font-semibold mb-3">Income and Expenses</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <c-input :field="form.annual_earning_pre_taxed" x-model="formData.annual_earning_pre_taxed"/>
                <c-input :field="form.annual_expenses" x-model="formData.annual_expenses"/>
                <c-input :field="form.target_annual_retirement_spending_pre_taxed"
                         x-model="formData.target_annual_retirement_spending_pre_taxed"/>
                <c-input :field="form.target_end_of_life_savings_pre_taxed" x-model="formData.target_end_of_life_savings_pre_taxed"/>
            </div>
        </div>

        <div class="p-3 border">
            <h2 class="text-2xl font-semibold mb-3">Savings</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <h3 class="text-xl font-semibold col-span-2">Bank</h3>
                <p class="text-sm text-skin-muted col-span-2">Accounts such as checking and savings grow with minimal interest and are taxed
                    annually.</p>
                <c-input :field="form.current_bank_savings" x-model="formData.current_bank_savings"/>
                <c-input :field="form.monthly_bank_contribution" x-model="formData.monthly_bank_contribution"/>

                <h3 class="text-xl font-semibold col-span-2">Tax Deferred</h3>
                <p class="text-sm text-skin-muted col-span-2">These grow tax-free until retirement, but withdrawals are taxed (e.g., 401(k),
                    Traditional IRA)..</p>
                <c-input :field="form.current_tax_deferred_savings" x-model="formData.current_tax_deferred_savings"/>
                <c-input :field="form.monthly_tax_deferred_contribution" x-model="formData.monthly_tax_deferred_contribution"/>

                <h3 class="text-xl font-semibold col-span-2">Taxable</h3>
                <p class="text-sm text-skin-muted col-span-2">Brokerage accounts where you pay taxes on capital gains, dividends, and
                    interest as they are realized.</p>
                <c-input :field="form.current_taxable_savings" x-model="formData.current_taxable_savings"/>
                <c-input :field="form.monthly_taxable_contribution" x-model="formData.monthly_taxable_contribution"/>

                <h3 class="text-xl font-semibold col-span-2">Tax Exempt</h3>
                <p class="text-sm text-skin-muted col-span-2">These are funded with post-tax dollars and can be withdrawn tax-free in
                    retirement (e.g., Roth IRA).</p>
                <c-input :field="form.current_tax_exempt_savings" x-model="formData.current_tax_exempt_savings"/>
                <c-input :field="form.monthly_tax_exempt_contribution" x-model="formData.monthly_tax_exempt_contribution"/>

            </div>
        </div>
    </div>

{% endblock %}

{% block javascript %}
    <script>
        function retirementCalculator() {
            return {
                formData: {
                    current_age: 30,
                    retirement_age: 65,
                    life_expectancy: 85,
                    current_tax_deferred_savings: null,
                    current_taxable_savings: null,
                    current_tax_exempt_savings: null,
                    current_bank_savings: null,
                    monthly_tax_deferred_contribution: null,
                    monthly_taxable_contribution: null,
                    monthly_tax_exempt_contribution: null,
                    monthly_bank_contribution: null,
                    annual_expenses: null,
                    inflation_rate: 2.0,
                    taxable_savings_growth_rate: 6.0,
                    tax_deferred_growth_rate: 7.0,
                    tax_rate: 25.0,
                    annual_earning_pre_taxed: null,
                    target_annual_retirement_spending_pre_taxed: null,
                    target_end_of_life_savings_pre_taxed: null,
                },
                results: null,
                calculateRetirement() {
                    // Here you would typically make an AJAX call to your backend
                    // For demonstration, we'll just set some dummy results
                    this.results = {
                        yearsUntilRetirement: this.formData.retirement_age - this.formData.current_age,
                        totalSavingsAtRetirement: (this.formData.current_tax_deferred_savings + this.formData.current_taxable_savings) *
                            Math.pow(1 + (this.formData.tax_deferred_growth_rate / 100), this.formData.retirement_age - this.formData.current_age),
                        // Add more calculated fields here
                    };
                }
            }
        }
    </script>
{% endblock %}